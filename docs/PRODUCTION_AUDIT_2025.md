# Production-–∞—É–¥–∏—Ç –∫–æ–¥–æ–≤–æ–π –±–∞–∑—ã AiLegalArmenia
## –ì–ª—É–±–æ–∫–∏–π —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑ ‚Äî 15 —Ñ–µ–≤—Ä–∞–ª—è 2026

---

## 1. –†–ï–ó–Æ–ú–ï

| –ö–∞—Ç–µ–≥–æ—Ä–∏—è | –ö—Ä–∏—Ç–∏—á. | –í—ã—Å–æ–∫–∏–π | –°—Ä–µ–¥–Ω–∏–π | –ù–∏–∑–∫–∏–π |
|-----------|---------|---------|---------|--------|
| –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å | 2 | 3 | 4 | 2 |
| –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ | 0 | 2 | 3 | 2 |
| –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å | 0 | 1 | 2 | 3 |
| –ù–∞–¥—ë–∂–Ω–æ—Å—Ç—å | 0 | 2 | 2 | 1 |
| **–ò—Ç–æ–≥–æ** | **2** | **8** | **11** | **8** |

**–û–±—â–∞—è –æ—Ü–µ–Ω–∫–∞: 7.2 / 10** ‚Äî —Å–∏—Å—Ç–µ–º–∞ –∑—Ä–µ–ª–∞—è, —Å –≥–ª—É–±–æ–∫–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å—é AI-—Å–ª–æ—è, –Ω–æ —Å –Ω–µ—Å–∫–æ–ª—å–∫–∏–º–∏ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–º–∏ –ø—Ä–æ–±–µ–ª–∞–º–∏ –≤ CORS –∏ PWA-–∫—ç—à–∏—Ä–æ–≤–∞–Ω–∏–∏.

---

## 2. –ë–ï–ó–û–ü–ê–°–ù–û–°–¢–¨

### üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ï

#### SEC-CRIT-1: Wildcard CORS –Ω–∞ –≤—Å–µ—Ö Edge Functions
**–§–∞–π–ª—ã:** 28 edge functions  
**–ü—Ä–æ–±–ª–µ–º–∞:** –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∏—Å–ø–æ–ª—å–∑—É—é—Ç `"Access-Control-Allow-Origin": "*"`, –Ω–µ—Å–º–æ—Ç—Ä—è –Ω–∞ –Ω–∞–ª–∏—á–∏–µ –≥–æ—Ç–æ–≤–æ–≥–æ –º–æ–¥—É–ª—è `edge-security.ts` —Å fail-closed CORS allowlist.  
**–†–∏—Å–∫:** –õ—é–±–æ–π –¥–æ–º–µ–Ω –º–æ–∂–µ—Ç –≤—ã–∑—ã–≤–∞—Ç—å API –æ—Ç –∏–º–µ–Ω–∏ –∑–∞–ª–æ–≥–∏–Ω–µ–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (CSRF-–∞—Ç–∞–∫–∞ —á–µ—Ä–µ–∑ bearer token).  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –Ω–∞ `getCorsHeaders()` –∏–∑ `_shared/edge-security.ts`. –ù–∞—Å—Ç—Ä–æ–∏—Ç—å `ALLOWED_ORIGINS` –∫–∞–∫ —Å–µ–∫—Ä–µ—Ç —Å –ø–µ—Ä–µ—á–∏—Å–ª–µ–Ω–∏–µ–º production-–¥–æ–º–µ–Ω–æ–≤.

#### SEC-CRIT-2: PWA Workbox –∫—ç—à–∏—Ä—É–µ—Ç —É—Å—Ç–∞—Ä–µ–≤—à–∏–π –¥–æ–º–µ–Ω Supabase
**–§–∞–π–ª:** `vite.config.ts:50`  
**–ü—Ä–æ–±–ª–µ–º–∞:** `runtimeCaching` –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ –¥–æ–º–µ–Ω `ktnygkszihdganoqamhi.supabase.co`, –∫–æ—Ç–æ—Ä—ã–π –Ω–µ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ç–µ–∫—É—â–µ–º—É –ø—Ä–æ–µ–∫—Ç—É (`nrmmgcgwriyrlbcpoqvk`).  
**–†–∏—Å–∫:** –ö—ç—à –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ API, –Ω–æ –ø–æ—Ç–µ–Ω—Ü–∏–∞–ª—å–Ω–æ –º–æ–∂–µ—Ç –∫—ç—à–∏—Ä–æ–≤–∞—Ç—å stale-–æ—Ç–≤–µ—Ç—ã –ø—Ä–∏ —Å–º–µ–Ω–µ –ø—Ä–æ–µ–∫—Ç–∞.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±–Ω–æ–≤–∏—Ç—å –ø–∞—Ç—Ç–µ—Ä–Ω –Ω–∞ —Ç–µ–∫—É—â–∏–π –¥–æ–º–µ–Ω –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `import.meta.env.VITE_SUPABASE_URL`.

### üü† –í–´–°–û–ö–ò–ï

#### SEC-HIGH-1: –†–∞—Å—à–∏—Ä–µ–Ω–∏—è PostgreSQL –≤ public-—Å—Ö–µ–º–µ
**–ò—Å—Ç–æ—á–Ω–∏–∫:** Supabase Linter (WARN 1, 2)  
**–ü—Ä–æ–±–ª–µ–º–∞:** Extensions —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã –≤ `public` –≤–º–µ—Å—Ç–æ –æ—Ç–¥–µ–ª—å–Ω–æ–π —Å—Ö–µ–º—ã (–Ω–∞–ø—Ä. `extensions`).  
**–†–∏—Å–∫:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ —Å –¥–æ—Å—Ç—É–ø–æ–º –∫ `public` –ø–æ–ª—É—á–∞—é—Ç –¥–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º —Ä–∞—Å—à–∏—Ä–µ–Ω–∏–π.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ú–∏–≥—Ä–∏—Ä–æ–≤–∞—Ç—å —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è –≤ —Å—Ö–µ–º—É `extensions`.

#### SEC-HIGH-2: Overly permissive RLS policy (USING true)
**–ò—Å—Ç–æ—á–Ω–∏–∫:** Supabase Linter (WARN 3)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –•–æ—Ç—è –±—ã –æ–¥–Ω–∞ —Ç–∞–±–ª–∏—Ü–∞ –∏–º–µ–µ—Ç INSERT/UPDATE/DELETE policy —Å `USING (true)`.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü—Ä–æ–≤–µ—Å—Ç–∏ —Ä–µ–≤—å—é –≤—Å–µ—Ö RLS-–ø–æ–ª–∏—Ç–∏–∫ —Å `true` –∏ –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –¥–æ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö —Ä–æ–ª–µ–π.

#### SEC-HIGH-3: Leaked password protection –æ—Ç–∫–ª—é—á–µ–Ω–∞
**–ò—Å—Ç–æ—á–Ω–∏–∫:** Supabase Linter (WARN 4)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–∞—Ä–æ–ª–∏.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–∫–ª—é—á–∏—Ç—å —á–µ—Ä–µ–∑ Cloud –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Auth.

### üü° –°–†–ï–î–ù–ò–ï

#### SEC-MED-1: `(supabase as any).rpc('soft_delete_case_file', ...)` 
**–§–∞–π–ª:** `src/hooks/useCaseFiles.ts:119`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ö–∞—Å—Ç–∏–Ω–≥ –∫ `any` –¥–ª—è –æ–±—Ö–æ–¥–∞ —Ç–∏–ø–∏–∑–∞—Ü–∏–∏. RPC –º–æ–∂–µ—Ç –Ω–µ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –∏–ª–∏ –∏–º–µ—Ç—å –¥—Ä—É–≥—É—é —Å–∏–≥–Ω–∞—Ç—É—Ä—É.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å RPC –≤ —Ç–∏–ø—ã –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `.rpc()` —Å –ø—Ä–∞–≤–∏–ª—å–Ω–æ–π —Ç–∏–ø–∏–∑–∞—Ü–∏–µ–π.

#### SEC-MED-2: `remember_me` ‚Äî —Å–µ—Å—Å–∏—è –≤ sessionStorage –±–µ–∑ –æ—á–∏—Å—Ç–∫–∏
**–§–∞–π–ª:** `src/pages/Login.tsx:80-87`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ `rememberMe=false` –¥–∞–Ω–Ω—ã–µ –ø–µ—Ä–µ–º–µ—â–∞—é—Ç—Å—è –∏–∑ localStorage –≤ sessionStorage. –û–¥–Ω–∞–∫–æ Supabase SDK –ø—Ä–æ–¥–æ–ª–∂–∞–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å localStorage (–∫–æ–Ω—Ñ–∏–≥ `client.ts`), —á—Ç–æ –º–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –õ–∏–±–æ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∏—Ä–æ–≤–∞—Ç—å `storage` –≤ Supabase-–∫–ª–∏–µ–Ω—Ç–µ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏, –ª–∏–±–æ —É–¥–∞–ª–∏—Ç—å –ª–æ–≥–∏–∫—É `rememberMe`.

#### SEC-MED-3: –¢–µ–ª–µ—Ñ–æ–Ω–Ω—ã–π –Ω–æ–º–µ—Ä –≤ Login.tsx –∑–∞—Ö–∞—Ä–¥–∫–æ–∂–µ–Ω
**–§–∞–π–ª:** `src/pages/Login.tsx:214`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–æ–º–µ—Ä `+374 10 123 456` –≤—ã–≥–ª—è–¥–∏—Ç –∫–∞–∫ –∑–∞–≥–ª—É—à–∫–∞, –Ω–µ –∫–∞–∫ —Ä–µ–∞–ª—å–Ω—ã–π –∫–æ–Ω—Ç–∞–∫—Ç–Ω—ã–π –Ω–æ–º–µ—Ä.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å i18n-–∫–ª—é—á –∏–ª–∏ env-–ø–µ—Ä–µ–º–µ–Ω–Ω—É—é.

#### SEC-MED-4: `generate-document` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `supabase` –±–µ–∑ –æ–±—ä—è–≤–ª–µ–Ω–∏—è
**–§–∞–π–ª:** `supabase/functions/generate-document/index.ts:85`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è `supabase` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –≤ –≤—ã–∑–æ–≤–µ `dualSearch({ supabase, ... })`, –Ω–æ –Ω–µ –æ–±—ä—è–≤–ª–µ–Ω–∞ –≤ —Å–∫–æ—É–ø–µ. `createClient` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –¥–ª—è `authClient`.  
**–†–∏—Å–∫:** Runtime-–æ—à–∏–±–∫–∞ `ReferenceError: supabase is not defined` –ø—Ä–∏ –ª—é–±–æ–º –∑–∞–ø—Ä–æ—Å–µ –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –¥–æ–∫—É–º–µ–Ω—Ç–∞ —Å RAG.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å —Å–æ–∑–¥–∞–Ω–∏–µ service_role –∫–ª–∏–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ –±–ª–æ–∫–æ–º RAG.

### üü¢ –ù–ò–ó–ö–ò–ï

#### SEC-LOW-1: `dangerouslySetInnerHTML` –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –≤ chart.tsx (shadcn)
–ù–µ —è–≤–ª—è–µ—Ç—Å—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–º –≤–≤–æ–¥–æ–º ‚Äî –±–µ–∑–æ–ø–∞—Å–Ω–æ.

#### SEC-LOW-2: No rate limiting –Ω–∞ frontend
–ù–µ—Ç debounce/throttle –Ω–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ñ–æ—Ä–º–∞—Ö (login, chat).

---

## 3. –ê–†–•–ò–¢–ï–ö–¢–£–†–ê

### üü† –í–´–°–û–ö–ò–ï

#### ARCH-HIGH-1: QueryClient –±–µ–∑ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –Ω–∞—Å—Ç—Ä–æ–µ–∫
**–§–∞–π–ª:** `src/App.tsx:29`  
**–ü—Ä–æ–±–ª–µ–º–∞:** `new QueryClient()` –±–µ–∑ `defaultOptions` ‚Äî retry 3 —Ä–∞–∑–∞, staleTime = 0, refetch –Ω–∞ —Ñ–æ–∫—É—Å –æ–∫–Ω–∞.  
**–í–ª–∏—è–Ω–∏–µ:** –ò–∑–±—ã—Ç–æ—á–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã –∫ API, –æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏ –≤–∫–ª–∞–¥–æ–∫.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:**
```ts
const queryClient = new QueryClient({
  defaultOptions: {
    queries: {
      staleTime: 5 * 60 * 1000,
      retry: 1,
      refetchOnWindowFocus: false,
    },
  },
});
```

#### ARCH-HIGH-2: –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ auth-–ª–æ–≥–∏–∫–∏
**–§–∞–π–ª—ã:** `useAuth.ts`, `ProtectedRoute.tsx`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –û–±–∞ –º–æ–¥—É–ª—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –≤—ã–∑—ã–≤–∞—é—Ç `supabase.auth.getSession()` –∏ `onAuthStateChange()`. `ProtectedRoute` –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `useAuth()`, —Å–æ–∑–¥–∞–≤–∞—è –¥–≤–µ –∫–æ–Ω–∫—É—Ä–∏—Ä—É—é—â–∏–µ –ø–æ–¥–ø–∏—Å–∫–∏.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í–≤–µ—Å—Ç–∏ `AuthProvider` (React Context) –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ–¥–∏–Ω—É—é –ø–æ–¥–ø–∏—Å–∫—É.

### üü° –°–†–ï–î–ù–ò–ï

#### ARCH-MED-1: –ú–æ–Ω–æ–ª–∏—Ç–Ω—ã–µ Edge Functions
**–§–∞–π–ª—ã:** `legal-practice-import/index.ts` (919 —Å—Ç—Ä–æ–∫), `ai-analyze/index.ts` (810+ —Å—Ç—Ä–æ–∫)  
**–ü—Ä–æ–±–ª–µ–º–∞:** –°–ª–æ–∂–Ω–æ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å, –æ—Ç–ª–∞–∂–∏–≤–∞—Ç—å, –¥–æ–±–∞–≤–ª—è—Ç—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –í—ã–Ω–µ—Å—Ç–∏ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫—É –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–µ –º–æ–¥—É–ª–∏, –æ—Å—Ç–∞–≤–∏–≤ –≤ `index.ts` —Ç–æ–ª—å–∫–æ —Ä–æ—É—Ç–∏–Ω–≥.

#### ARCH-MED-2: –î—É–∞–ª–∏–∑–º —Ö—Ä–∞–Ω–µ–Ω–∏—è (knowledge_base vs legal_documents)
–î–≤–µ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–µ —Å–∏—Å—Ç–µ–º—ã —Ö—Ä–∞–Ω–µ–Ω–∏—è –Ω–æ—Ä–º–∞—Ç–∏–≤–Ω—ã—Ö —Ç–µ–∫—Å—Ç–æ–≤ —É—Å–ª–æ–∂–Ω—è—é—Ç –ø–æ–∏—Å–∫ –∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ó–∞–¥–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —á—ë—Ç–∫–∏–µ –≥—Ä–∞–Ω–∏—Ü—ã –∏ –º–∏–≥—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π –ø–ª–∞–Ω.

#### ARCH-MED-3: i18n ‚Äî –¥–≤–æ–π–Ω–æ–π –∏–º–ø–æ—Ä—Ç –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
**–§–∞–π–ª—ã:** `src/main.tsx:5`, `src/App.tsx:10`  
**–ü—Ä–æ–±–ª–µ–º–∞:** `import "@/i18n/config"` –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –¥–≤–∞–∂–¥—ã.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –£–¥–∞–ª–∏—Ç—å –∏–∑ `App.tsx` (–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤ `main.tsx`).

### üü¢ –ù–ò–ó–ö–ò–ï

#### ARCH-LOW-1: Lazy loading –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω
Dashboard, AdminPanel –∏ –¥—Ä—É–≥–∏–µ —Ç—è–∂—ë–ª—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é.

#### ARCH-LOW-2: Skip-to-content —Å—Å—ã–ª–∫–∞ –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É–µ—Ç
Accessibility baseline —Å–æ–±–ª—é–¥—ë–Ω.

---

## 4. –ü–†–û–ò–ó–í–û–î–ò–¢–ï–õ–¨–ù–û–°–¢–¨

### üü† –í–´–°–û–ö–ò–ï

#### PERF-HIGH-1: `useBulkImport` ‚Äî –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞
**–§–∞–π–ª:** `src/hooks/useBulkImport.ts:290`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –§–∞–π–ª—ã –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞—é—Ç—Å—è —Å—Ç—Ä–æ–≥–æ –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ (for...of + await).  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º concurrency (Promise.allSettled + semaphore, batch –ø–æ 3-5).

### üü° –°–†–ï–î–ù–ò–ï

#### PERF-MED-1: `useAuth()` ‚Äî —Ç—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–∏ –Ω–∞ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
–ö–∞–∂–¥—ã–π –≤—ã–∑–æ–≤ `useAuth()` —Å–æ–∑–¥–∞—ë—Ç –Ω–æ–≤—ã–π `useEffect` —Å –ø–æ–¥–ø–∏—Å–∫–æ–π. –ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ –≤ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö ‚Äî –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏.

#### PERF-MED-2: `buildPreview()` –ø–µ—Ä–µ—Å–æ–∑–¥–∞—ë—Ç—Å—è –ø—Ä–∏ –∫–∞–∂–¥–æ–º —Ä–µ–Ω–¥–µ—Ä–µ
**–§–∞–π–ª:** `ImportWizard.tsx:190`  
–ó–∞–≤–∏—Å–∏—Ç –æ—Ç `source, files, url, urlList, pastedText, jsonlRecords, options` ‚Äî –Ω–æ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ —à–∞–≥–µ 3‚Üí4.

### üü¢ –ù–ò–ó–ö–ò–ï

#### PERF-LOW-1: `useMemo` –¥–ª—è `normalizeUsername` –Ω–µ –Ω—É–∂–µ–Ω
**–§–∞–π–ª:** `Login.tsx:47`  
–ß–∏—Å—Ç–∞—è —Ñ—É–Ω–∫—Ü–∏—è –±–µ–∑ –≤—ã—á–∏—Å–ª–∏—Ç–µ–ª—å–Ω–æ–π –Ω–∞–≥—Ä—É–∑–∫–∏ ‚Äî `useMemo` –±–µ–∑ –ø–æ–ª—å–∑—ã.

#### PERF-LOW-2: React.forwardRef –≤ UI-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö
–í—Å–µ shadcn-–∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `forwardRef` ‚Äî –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.

#### PERF-LOW-3: –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç React.StrictMode
`src/main.tsx` –Ω–µ –æ–±–æ—Ä–∞—á–∏–≤–∞–µ—Ç `<App />` –≤ `<StrictMode>`.

---

## 5. –ù–ê–î–Å–ñ–ù–û–°–¢–¨

### üü† –í–´–°–û–ö–ò–ï

#### REL-HIGH-1: –ù–µ—Ç –≥–ª–æ–±–∞–ª—å–Ω–æ–≥–æ Error Boundary
**–§–∞–π–ª:** `src/App.tsx`  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ù–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω–∞—è –æ—à–∏–±–∫–∞ –≤ –ª—é–±–æ–º lazy-loaded –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–µ –∫—Ä–∞—à–∏—Ç –≤—Å—ë –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ.  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –û–±–µ—Ä–Ω—É—Ç—å `<Routes>` –≤ `<ErrorBoundary>` —Å —Ñ–æ–ª–ª–±—ç–∫–æ–º.

#### REL-HIGH-2: Edge Functions –Ω–µ –∏–º–µ—é—Ç —Ç–∞–π–º–∞—É—Ç–æ–≤ –Ω–∞ AI-–≤—ã–∑–æ–≤—ã
**–§–∞–π–ª—ã:** –í—Å–µ `fetch("https://ai.gateway.lovable.dev/...")` –≤—ã–∑–æ–≤—ã.  
**–ü—Ä–æ–±–ª–µ–º–∞:** –ü—Ä–∏ –∑–∞–≤–∏—Å–∞–Ω–∏–∏ AI gateway —Ñ—É–Ω–∫—Ü–∏—è –¥–µ—Ä–∂–∏—Ç —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –¥–æ —Ç–∞–π–º–∞—É—Ç–∞ Deno (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 150 —Å–µ–∫).  
**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `AbortController` —Å —Ç–∞–π–º–∞—É—Ç–æ–º 30-60 —Å–µ–∫.

### üü° –°–†–ï–î–ù–ò–ï

#### REL-MED-1: `ProtectedRoute` –Ω–µ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç expired session
–ï—Å–ª–∏ —Å–µ—Å—Å–∏—è –∏—Å—Ç–µ–∫–ª–∞ –º–µ–∂–¥—É `getSession()` –∏ —Ä–µ–Ω–¥–µ—Ä–æ–º, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –º–æ–∂–µ—Ç —É–≤–∏–¥–µ—Ç—å –º–≥–Ω–æ–≤–µ–Ω–Ω—ã–π flash –∫–æ–Ω—Ç–µ–Ω—Ç–∞ –ø–µ—Ä–µ–¥ —Ä–µ–¥–∏—Ä–µ–∫—Ç–æ–º.

#### REL-MED-2: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ retry-–ª–æ–≥–∏–∫–∏ –≤ edge functions –ø—Ä–∏ 429
–ü—Ä–∏ rate limit AI gateway —Ñ—É–Ω–∫—Ü–∏–∏ –≤–æ–∑–≤—Ä–∞—â–∞—é—Ç –æ—à–∏–±–∫—É, –Ω–æ –Ω–µ —Ä–µ—Ç—Ä–∞—è—Ç —Å —ç–∫—Å–ø–æ–Ω–µ–Ω—Ü–∏–∞–ª—å–Ω—ã–º backoff.

### üü¢ –ù–ò–ó–ö–ò–ï

#### REL-LOW-1: `clearAll()` –≤ useBulkImport –ø—Ä–∞–≤–∏–ª—å–Ω–æ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç ref –∏ state
–†–µ–∞–ª–∏–∑–∞—Ü–∏—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞.

---

## 6. AI-–°–ü–ï–¶–ò–§–ò–ß–ù–´–ï –ü–†–û–í–ï–†–ö–ò

### ‚úÖ Prompt Injection Protection ‚Äî –ó–†–ï–õ–ê–Ø
- `prompt-armor.ts`: 15+ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤ –¥–µ—Ç–µ–∫—Ü–∏–∏, –Ω–µ–π—Ç—Ä–∞–ª–∏–∑–∞—Ü–∏—è, –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
- Fenced data blocks (`BEGIN USER DATA / END USER DATA`)
- `ANTI_INJECTION_RULES` –¥–æ–±–∞–≤–ª—è–µ—Ç—Å—è –∫–æ –≤—Å–µ–º —Å–∏—Å—Ç–µ–º–Ω—ã–º –ø—Ä–æ–º–ø—Ç–∞–º
- JSON output validation + repair pass —á–µ—Ä–µ–∑ lightweight –º–æ–¥–µ–ª—å

### ‚úÖ RAG Pipeline ‚Äî PRODUCTION-GRADE
- –ì–∏–±—Ä–∏–¥–Ω—ã–π –ø–æ–∏—Å–∫ (vector + keyword) —á–µ—Ä–µ–∑ `dualSearch()`
- Token budget limiter (`applyBudgets()`) –¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è –∫–æ–Ω—Ç–µ–∫—Å—Ç–∞
- Temporal filtering –ø–æ –¥–∞—Ç–µ –¥–µ–ª–∞
- PII redaction –¥–ª—è –ª–æ–≥–æ–≤

### ‚úÖ Model Config ‚Äî –¶–ï–ù–¢–†–ê–õ–ò–ó–û–í–ê–ù–ù–ê–Ø
- `model-config.ts` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –≤—Å–µ –º–æ–¥–µ–ª–∏ –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
- –ï–¥–∏–Ω—ã–π gateway `ai.gateway.lovable.dev`
- Structured logging —á–µ—Ä–µ–∑ `safe-logger.ts`

### ‚ö†Ô∏è Hallucination Guard ‚Äî –ù–£–ñ–î–ê–ï–¢–°–Ø –í –£–°–ò–õ–ï–ù–ò–ò
- –ú–æ–¥–µ–ª–∏ –∏–Ω–æ–≥–¥–∞ –∏–≥–Ω–æ—Ä–∏—Ä—É—é—Ç `DATA_GAP` –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—é –∏ –∑–∞–ø–æ–ª–Ω—è—é—Ç –ø—Ä–æ–±–µ–ª—ã
- –ù–µ—Ç post-processing –ø—Ä–æ–≤–µ—Ä–∫–∏ –Ω–∞–ª–∏—á–∏—è `_____` –º–∞—Ä–∫–µ—Ä–æ–≤ –≤ –≤—ã—Ö–æ–¥–µ
- **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:** –î–æ–±–∞–≤–∏—Ç—å –≤–∞–ª–∏–¥–∞—Ü–∏—é –≤ edge functions –ø–µ—Ä–µ–¥ –≤–æ–∑–≤—Ä–∞—Ç–æ–º –æ—Ç–≤–µ—Ç–∞

---

## 7. –ú–ê–¢–†–ò–¶–ê –ü–†–ò–û–†–ò–¢–ï–¢–û–í

| # | –ù–∞–π–¥–µ–Ω–æ | –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –£—Å–∏–ª–∏–µ |
|---|---------|-----------|--------|
| SEC-CRIT-1 | Wildcard CORS | P0 | 2-3—á |
| SEC-MED-4 | `supabase` undefined –≤ generate-document | P0 | 15–º |
| SEC-CRIT-2 | PWA –∫—ç—à –Ω–µ–≤–µ—Ä–Ω—ã–π –¥–æ–º–µ–Ω | P1 | 15–º |
| REL-HIGH-1 | –ù–µ—Ç ErrorBoundary | P1 | 30–º |
| ARCH-HIGH-1 | QueryClient defaults | P1 | 15–º |
| ARCH-HIGH-2 | Auth Provider | P2 | 2—á |
| SEC-HIGH-3 | Leaked password protection | P2 | 5–º |
| REL-HIGH-2 | AI timeout | P2 | 1—á |
| PERF-HIGH-1 | –ü–∞—Ä–∞–ª–ª–µ–ª—å–Ω—ã–π bulk import | P3 | 2—á |
| ARCH-MED-1 | –†–µ—Ñ–∞–∫—Ç–æ—Ä–∏–Ω–≥ edge functions | P3 | 4—á |

---

## 8. –ß–¢–û –†–ï–ê–õ–ò–ó–û–í–ê–ù–û –•–û–†–û–®–û

1. **RLS –Ω–∞ –≤—Å–µ—Ö 36 —Ç–∞–±–ª–∏—Ü–∞—Ö** ‚Äî 100% –ø–æ–∫—Ä—ã—Ç–∏–µ, –≤—Å–µ —Ç–∞–±–ª–∏—Ü—ã –∏–º–µ—é—Ç `rowsecurity = true` —Å –æ—Ç 1 –¥–æ 9 –ø–æ–ª–∏—Ç–∏–∫
2. **Auth guard –Ω–∞ –≤—Å–µ—Ö AI-—Ñ—É–Ω–∫—Ü–∏—è—Ö** ‚Äî Bearer token –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ `getUser()`
3. **–ú–æ–¥—É–ª—å–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–º–ø—Ç–æ–≤** ‚Äî —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Ç–∏–ø–∞–º –∞–Ω–∞–ª–∏–∑–∞, —Ä–æ–ª—è–º, —é—Ä–∏—Å–¥–∏–∫—Ü–∏—è–º
4. **Lazy loading** ‚Äî —Ç—è–∂—ë–ª—ã–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è –ø–æ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—é
5. **i18n** ‚Äî 3 —è–∑—ã–∫–∞ (HY, RU, EN) —Å –ø–æ–ª–Ω—ã–º –ø–æ–∫—Ä—ã—Ç–∏–µ–º
6. **Input sanitization** ‚Äî –≥–ª—É–±–æ–∫–∞—è –æ—á–∏—Å—Ç–∫–∞ Unicode, NUL-–±–∞–π—Ç–æ–≤, —É–ø—Ä–∞–≤–ª—è—é—â–∏—Ö —Å–∏–º–≤–æ–ª–æ–≤
7. **Audit logging** ‚Äî —Ç–∞–±–ª–∏—Ü–∞ `audit_logs` —Å IP, user_agent, –¥–µ–π—Å—Ç–≤–∏–µ–º
8. **PII encryption** ‚Äî –æ—Ç–¥–µ–ª—å–Ω–∞—è —Ç–∞–±–ª–∏—Ü–∞ `encrypted_pii` —Å IV
9. **Soft delete** ‚Äî –∫–µ–π—Å—ã –∏ —Ñ–∞–π–ª—ã –∏—Å–ø–æ–ª—å–∑—É—é—Ç `deleted_at` –≤–º–µ—Å—Ç–æ —Ñ–∏–∑–∏—á–µ—Å–∫–æ–≥–æ —É–¥–∞–ª–µ–Ω–∏—è
10. **Service Role Key** –Ω–µ —É—Ç–µ–∫–∞–µ—Ç –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥ (–ø—Ä–æ–≤–µ—Ä–µ–Ω–æ: 0 –≤—Ö–æ–∂–¥–µ–Ω–∏–π –≤ `src/`)

---

*–û—Ç—á—ë—Ç —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω: 15.02.2026*  
*–û—Ö–≤–∞—Ç: 36 —Ç–∞–±–ª–∏—Ü, 28 edge functions, ~200 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤, ~50 000 LOC*
